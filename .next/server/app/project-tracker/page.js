(()=>{var e={};e.id=661,e.ids=[661],e.modules={124:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(687),a=r(5814),l=r.n(a),n=r(6189),i=r(3210);function d(){let e=(0,n.usePathname)(),t=(0,n.useRouter)(),[r,a]=(0,i.useState)(null);return(0,s.jsx)("header",{className:"bg-gradient-to-r from-blue-600 to-purple-600 shadow-lg border-b border-blue-500",children:(0,s.jsx)("div",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-white tracking-wide",children:"Project Tracker"})}),(0,s.jsx)("nav",{className:"flex items-center space-x-2",children:[{name:"Dashboard",path:"/project-tracker/dashboard"},{name:"Project Tracker",path:"/project-tracker"},{name:"Task Tracker",path:"/task-tracker"}].map(t=>{var r;let a="/project-tracker/dashboard"===(r=t.path)?"/project-tracker/dashboard"===e||e.startsWith("/project-tracker/dashboard/"):"/project-tracker"===r?"/project-tracker"===e||e.startsWith("/project-tracker/")&&!e.startsWith("/project-tracker/dashboard"):e===r||e.startsWith(r+"/");return(0,s.jsx)(l(),{href:t.path,className:`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap cursor-pointer transition-all duration-200 ${a?"bg-white text-blue-600 shadow-md transform scale-105":"text-blue-100 hover:text-white hover:bg-white/20 hover:shadow-md"}`,children:t.name},t.path)})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(l(),{href:"/",className:"px-4 py-2 rounded-lg text-sm font-medium text-blue-100 hover:text-white hover:bg-white/20 transition-all duration-200 whitespace-nowrap",children:[(0,s.jsx)("i",{className:"ri-arrow-left-line mr-2"}),"Back to Portal"]}),r&&(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"text-sm text-blue-100 hidden sm:block",children:(0,s.jsx)("span",{className:"font-semibold",children:r.name})}),(0,s.jsxs)("button",{onClick:()=>{localStorage.removeItem("currentUser"),localStorage.removeItem("token"),t.push("/login")},className:"flex items-center px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-lg transition-all duration-200 hover:shadow-lg transform hover:scale-105 cursor-pointer whitespace-nowrap",children:[(0,s.jsx)("i",{className:"ri-logout-box-line mr-2"}),"Logout"]})]})]})]})})})}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1142:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(687),a=r(3210),l=r(6189);function n({children:e}){let[t,r]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!0);return((0,l.useRouter)(),n)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("i",{className:"ri-loader-4-line animate-spin text-2xl text-blue-600"}),(0,s.jsx)("span",{className:"text-gray-600",children:"Loading..."})]})}):t?(0,s.jsx)(s.Fragment,{children:e}):null}},1490:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Sumit Mishra\\\\OneDrive - EcoSoul Home\\\\Documents\\\\Project trackerr\\\\Project tracker\\\\app\\\\project-tracker\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\project-tracker\\page.tsx","default")},2862:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(687),a=r(3210),l=r(5814),n=r.n(l),i=r(124);let d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=(e,t,r)=>Math.max(t,Math.min(r,e));function c({projects:e,tasks:t}){let[r,l]=(0,a.useState)("day"),[n,i]=(0,a.useState)(null),c=(0,a.useMemo)(()=>{let e={};return(t||[]).forEach(t=>{let r=t.projectId;r&&(e[r]||(e[r]=[]),e[r].push(t))}),e},[t]),m=e=>{if(!e)return;let t=new Date(e);return isNaN(t.getTime())?void 0:t},x=(0,a.useMemo)(()=>{try{let r=new Date(2025,7,8),s=new Date(r);e.forEach(e=>{let t=m(e.dueDate);t&&t>s&&(s=t)}),(t||[]).forEach(e=>{let t=m(e.eta);t&&t>s&&(s=t)});let a=new Date(r);return a.setDate(r.getDate()+91-1),s<a&&(s=a),{start:r,end:s}}catch(e){return console.error("Error calculating range:",e),{start:new Date(2025,7,8),end:new Date(2025,10,30)}}},[e,t]),u=(0,a.useMemo)(()=>{try{let e=[],t=new Date(x.start);for(;t<=x.end&&e.length<370;)e.push(new Date(t)),t.setDate(t.getDate()+1);return e}catch(e){return console.error("Error calculating days:",e),[]}},[x]),h=e=>{try{let t=m(e);if(!t)return 0;let r=Math.floor((t.getTime()-x.start.getTime())/864e5);return Math.max(0,Math.min(u.length-1,r))}catch(e){return console.error("Error calculating dayIndex:",e),0}},p=(0,a.useMemo)(()=>{try{let e=[],t=new Date(x.start.getFullYear(),x.start.getMonth(),1),r=new Date(x.end.getFullYear(),x.end.getMonth(),1),s=t;for(;s<=r&&e.length<60;)e.push(new Date(s)),s=new Date(s.getFullYear(),s.getMonth()+1,1);return e}catch(e){return console.error("Error calculating months:",e),[]}},[x]),g=e=>{try{let t=m(e);if(!t)return 0;let r=new Date(t.getFullYear(),t.getMonth(),1),s=p.findIndex(e=>e.getFullYear()===r.getFullYear()&&e.getMonth()===r.getMonth());if(-1===s)return t<x.start?0:p.length-1;return s}catch(e){return console.error("Error calculating monthIndexFromDate:",e),0}},b="day"===r?u:p,j=e=>`${o(e,0,b.length)/b.length*100}%`,y=e=>"day"===r?h(e):g(e),f=(e,t)=>{try{if("day"===r){let r=h(e)+1;return Math.max(t??0,Math.min(r,u.length-1))}let s=g(e)+1;return Math.max(t??0,Math.min(s,p.length-1))}catch(e){return console.error("Error calculating indexFromDateEnd:",e),t??0}},v=new Date(2025,7,20),N=Math.floor((v.getTime()-x.start.getTime())/864e5),w=p.findIndex(e=>e.getFullYear()===v.getFullYear()&&e.getMonth()===v.getMonth()),D=new Date(v.getFullYear(),v.getMonth()+1,0).getDate(),k=v.getDate()/D,S="day"===r?N+.5:(w<0?v<x.start?0:p.length:w)+k,C=j(S),M=(0,a.useMemo)(()=>{if("day"!==r)return[];let e=[],t=["#2dd4bf","#60a5fa","#fb923c","#a78bfa"];x.start;let s=0,a=1;for(;s<u.length;){let r=Math.min(u.length,s+7);e.push({label:`Week ${a}`,start:s,end:r,color:t[(a-1)%t.length]}),s=r,a++}return e},[u,r,x.start]),[P,T]=(0,a.useState)({}),A=e=>T(t=>({...t,[e]:!t[e]}));return b.length?(console.log("Gantt Debug:",{rangeStart:x.start.toLocaleDateString(),rangeEnd:x.end.toLocaleDateString(),daysLength:u.length,projects:e.map(e=>({title:e.title,start:e.startDate,startDate:new Date(e.startDate).toLocaleDateString(),dayIndex:h(e.startDate)}))}),(0,s.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-3 border-b border-gray-200 flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:"Gantt Chart"}),(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-700",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,s.jsx)("span",{className:"w-3 h-3 rounded bg-green-500"})," Completed (till today)"]}),(0,s.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,s.jsx)("span",{className:"w-3 h-3 rounded bg-gray-300"})," Remaining"]})]}),(0,s.jsx)("div",{className:"flex items-center bg-gray-100 rounded-full p-1",children:["day","month"].map(e=>(0,s.jsx)("button",{onClick:()=>l(e),className:`px-3 py-1 text-sm rounded-full transition-colors ${r===e?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:"day"===e?"Day":"Month"},e))})]})]}),(0,s.jsxs)("div",{className:"relative overflow-x-auto",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-white/85 backdrop-blur supports-[backdrop-filter]:bg-white/70",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:"grid text-[10px] font-semibold text-white",style:{gridTemplateColumns:`280px repeat(${b.length}, minmax(36px, 1fr))`},children:[(0,s.jsx)("div",{className:"py-1 pl-6 bg-white"}),b.map((e,t)=>(0,s.jsx)("div",{className:"py-1 bg-white"},`placeholder-${t}`)),"day"===r&&M.map((e,t)=>(0,s.jsxs)("div",{className:"absolute top-0 left-0 h-6 flex items-center justify-center rounded-md text-[10px] cursor-pointer hover:opacity-90",style:{marginLeft:"280px",left:`calc(${j(e.start)})`,width:`calc(${j(e.end)} - ${j(e.start)})`,backgroundColor:e.color},onMouseEnter:()=>{i({label:`Week ${t+1}`,start:u[e.start],end:u[Math.max(e.start,e.end-1)],left:`calc(280px + ${j(e.start)})`,width:`calc(${j(e.end)} - ${j(e.start)})`})},onMouseLeave:()=>i(null),children:["Week ",t+1]},`week-${t}`))]}),"day"===r?(0,s.jsxs)("div",{className:"grid text-[10px] font-medium text-gray-700 border-b border-gray-200",style:{gridTemplateColumns:`280px repeat(${b.length}, minmax(36px, 1fr))`},children:[(0,s.jsx)("div",{className:"py-2 pl-6 bg-white",children:"Project / Task"}),u.map((e,t)=>(0,s.jsx)("div",{className:"py-2 text-center",children:["S","M","T","W","T","F","S"][e.getDay()]},`d-${t}`))]}):(0,s.jsxs)("div",{className:"grid text-[10px] font-medium text-gray-700 border-b border-gray-200",style:{gridTemplateColumns:`280px repeat(${b.length}, minmax(60px, 1fr))`},children:[(0,s.jsx)("div",{className:"py-2 pl-6 bg-white",children:"Project / Task"}),p.map((e,t)=>(0,s.jsxs)("div",{className:"py-2 text-center",children:[d[e.getMonth()]," ",e.getFullYear()]},`m-${t}`))]})]})}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-0 z-30",children:(0,s.jsx)("div",{className:"absolute top-0 bottom-0 border-r-2 border-sky-600",style:{left:`calc(280px + ${C})`}})}),(0,s.jsx)("div",{className:"pointer-events-none absolute z-40",style:{left:`calc(280px + ${C})`,top:24},children:(0,s.jsx)("div",{className:"translate-x-[-50%] text-[10px] bg-sky-600 text-white px-2 py-0.5 rounded-sm shadow",children:"Today"})}),n&&(0,s.jsxs)("div",{className:"absolute z-20 mt-1 text-[11px] bg-white border border-gray-200 rounded-md shadow px-2 py-1",style:{left:n.left,top:28},onMouseLeave:()=>i(null),children:[(0,s.jsx)("div",{className:"font-semibold mb-0.5",children:n.label}),(0,s.jsxs)("div",{className:"text-gray-600",children:[n.start.toLocaleDateString()," – ",n.end.toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:e.map(e=>{let t=e._id||e.id,r=c[t]||[];return(0,s.jsxs)("div",{className:"px-6 py-4",children:[(0,s.jsxs)("div",{className:"grid items-center",style:{gridTemplateColumns:`280px repeat(${b.length}, minmax(36px, 1fr))`},children:[(0,s.jsxs)("div",{className:"pr-3",children:[(0,s.jsxs)("button",{onClick:()=>A(t),className:"flex items-center gap-2 text-left",children:[(0,s.jsx)("span",{className:`transition-transform ${P[t]?"rotate-90":""}`,children:"▶"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:e.title})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[new Date(e.startDate).toLocaleDateString()," – ",new Date(e.dueDate).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"relative",style:{gridColumn:"2 / -1"},children:(0,s.jsx)("div",{className:"gantt-timeline h-6",children:(()=>{try{let t=y(e.startDate),r=f(e.dueDate,t),a=o(S,t,r),l=new Date(e.startDate).toLocaleDateString(),n=new Date(e.dueDate).toLocaleDateString(),i=`${e.title}: ${l} – ${n}`,d=[];return a>t&&d.push({left:j(t),width:`calc(${j(a)} - ${j(t)})`,cls:"bg-green-500",title:i}),r>a&&d.push({left:j(a),width:`calc(${j(r)} - ${j(a)})`,cls:"bg-gray-300",title:i}),d.map((e,t)=>(0,s.jsx)("div",{title:e.title,className:`absolute top-1/2 -translate-y-1/2 rounded-sm shadow-sm ${e.cls}`,style:{left:e.left,width:e.width,height:"8px"}},t))}catch(e){return console.error("Error rendering project bar:",e),null}})()})})]}),(0,s.jsx)("div",{className:`mt-3 overflow-hidden transition-all duration-300 ${P[t]?"max-h-[800px] opacity-100":"max-h-0 opacity-0"}`,children:(0,s.jsxs)("div",{className:"space-y-2",children:[r.map(t=>{let r=y(t.startDate||e.startDate),a=f(t.eta,r);return(0,s.jsxs)("div",{className:"grid items-center",style:{gridTemplateColumns:`280px repeat(${b.length}, minmax(36px, 1fr))`},children:[(0,s.jsx)("div",{className:"pl-4 pr-3",children:(0,s.jsx)("div",{className:"text-xs text-gray-700",children:t.task})}),(0,s.jsx)("div",{className:"relative",style:{gridColumn:"2 / -1"},children:(0,s.jsx)("div",{className:"gantt-timeline h-6",children:(()=>{try{let e=o(S,r,a),l=[];return e>r&&l.push({left:j(r),width:`calc(${j(e)} - ${j(r)})`,cls:"bg-green-500"}),a>e&&l.push({left:j(e),width:`calc(${j(a)} - ${j(e)})`,cls:"bg-gray-300"}),l.map((e,r)=>(0,s.jsx)("div",{title:`${t.task}: ${t.startDate?new Date(t.startDate).toLocaleDateString():""} – ${new Date(t.eta).toLocaleDateString()} (${t.status})`,className:`absolute top-1/2 -translate-y-1/2 rounded-sm shadow-sm hover:shadow ${e.cls}`,style:{left:e.left,width:e.width,height:"6px"}},r))}catch(e){return console.error("Error rendering task bar:",e),null}})()})})]},t._id)}),0===r.length&&(0,s.jsx)("div",{className:"pl-4 text-xs text-gray-400",children:"No tasks"})]})})]},t)})})]})]})):(0,s.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:"Loading Gantt chart..."})}var m=r(3966);function x({onSave:e,onClose:t}){let[r,l]=(0,a.useState)({title:"",description:"",status:"Active",priority:"Medium",startDate:new Date().toISOString().split("T")[0],dueDate:"",assignedTo:[]}),[n,i]=(0,a.useState)([]),[d,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null),[x,u]=(0,a.useState)(""),h=(e,t)=>{l(r=>({...r,[e]:t}))},p=e=>{l(t=>({...t,assignedTo:t.assignedTo.includes(e)?t.assignedTo.filter(t=>t!==e):[...t.assignedTo,e]}))},{sameDepartment:g,differentDepartment:b}=(()=>{if(!c)return{sameDepartment:[],differentDepartment:[]};let e=n.filter(e=>e.name.toLowerCase().includes(x.toLowerCase())||e.email.toLowerCase().includes(x.toLowerCase())||e.department.toLowerCase().includes(x.toLowerCase()));return{sameDepartment:e.filter(e=>e.department===c.department),differentDepartment:e.filter(e=>e.department!==c.department)}})();return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-7xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Project"}),(0,s.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 cursor-pointer",children:(0,s.jsx)("i",{className:"ri-close-line w-6 h-6"})})]})}),(0,s.jsxs)("form",{onSubmit:t=>{t.preventDefault(),o(!0);let s=r.assignedTo.map(e=>({user:e,role:"employee"}));e({...r,startDate:r.startDate,dueDate:r.dueDate,assignedTo:r.assignedTo,teamMembers:s}),o(!1)},className:"p-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Title"}),(0,s.jsx)("input",{type:"text",value:r.title,onChange:e=>h("title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:r.description,onChange:e=>h("description",e.target.value),rows:4,maxLength:500,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{value:r.status,onChange:e=>h("status",e.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"Active",children:"Active"}),(0,s.jsx)("option",{value:"On Hold",children:"On Hold"}),(0,s.jsx)("option",{value:"Completed",children:"Completed"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),(0,s.jsxs)("select",{value:r.priority,onChange:e=>h("priority",e.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"Low",children:"Low"}),(0,s.jsx)("option",{value:"Medium",children:"Medium"}),(0,s.jsx)("option",{value:"High",children:"High"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),(0,s.jsx)("input",{type:"date",value:r.startDate,onChange:e=>h("startDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),(0,s.jsx)("input",{type:"date",value:r.dueDate,onChange:e=>h("dueDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Team Members"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Project Team Members"}),0===r.assignedTo.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No team members assigned to this project"}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:r.assignedTo.map(e=>{let t=n.find(t=>t._id===e);return t?(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:t.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:t.email}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:t.department})]}),(0,s.jsx)("button",{onClick:()=>p(e),disabled:d,className:"text-red-600 hover:text-red-800 text-sm font-medium disabled:opacity-50 p-1 hover:bg-red-50 rounded ml-2",title:"Remove team member",children:(0,s.jsx)("i",{className:"ri-close-line w-4 h-4"})})]},e):null})})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Team Members"}),(0,s.jsx)("input",{type:"text",value:x,onChange:e=>u(e.target.value),placeholder:"Search by name, email, or department...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["My Team Members (",g.length,")",(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"• Same Department"})]}),0===g.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No available team members from your department"}):(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3",children:g.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 py-2 cursor-pointer hover:bg-gray-50 rounded px-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:r.assignedTo.includes(e._id),onChange:()=>p(e._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.role," • ",e.department]})]})]},e._id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Adhoc Team Members (",b.length,")",(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"• Different Departments"})]}),0===b.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No available team members from different departments"}):(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3",children:b.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 py-2 cursor-pointer hover:bg-gray-50 rounded px-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:r.assignedTo.includes(e._id),onChange:()=>p(e._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.role," • ",e.department]})]})]},e._id))})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-8",children:[(0,s.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 cursor-pointer whitespace-nowrap",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700 cursor-pointer whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Creating...":"Create Project"})]})]})]})})}function u({project:e,onSave:t,onClose:r}){let[l,n]=(0,a.useState)({title:e.title,description:e.description,status:e.status,priority:e.priority,startDate:e.startDate,dueDate:e.dueDate,assignedTo:e.assignedTo?.map(e=>e._id)||[]}),[i,d]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null),[u,h]=(0,a.useState)(""),p=(e,t)=>{n(r=>({...r,[e]:t}))},g=e=>{n(t=>({...t,assignedTo:t.assignedTo.includes(e)?t.assignedTo.filter(t=>t!==e):[...t.assignedTo,e]}))},{sameDepartment:b,differentDepartment:j}=(()=>{if(!m)return{sameDepartment:[],differentDepartment:[]};let e=i.filter(e=>e.name.toLowerCase().includes(u.toLowerCase())||e.email.toLowerCase().includes(u.toLowerCase())||e.department.toLowerCase().includes(u.toLowerCase()));return{sameDepartment:e.filter(e=>e.department===m.department),differentDepartment:e.filter(e=>e.department!==m.department)}})();return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-7xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Project"}),(0,s.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 cursor-pointer",children:(0,s.jsx)("i",{className:"ri-close-line w-6 h-6"})})]})}),(0,s.jsxs)("form",{onSubmit:r=>{r.preventDefault(),c(!0);let s=l.assignedTo.map(e=>({user:e,role:"employee"})),a={...l,startDate:l.startDate,dueDate:l.dueDate,assignedTo:l.assignedTo,teamMembers:s};t(e._id,a),c(!1)},className:"p-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Title"}),(0,s.jsx)("input",{type:"text",value:l.title,onChange:e=>p("title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:l.description,onChange:e=>p("description",e.target.value),rows:4,maxLength:500,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{value:l.status,onChange:e=>p("status",e.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"Active",children:"Active"}),(0,s.jsx)("option",{value:"On Hold",children:"On Hold"}),(0,s.jsx)("option",{value:"Completed",children:"Completed"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),(0,s.jsxs)("select",{value:l.priority,onChange:e=>p("priority",e.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"Low",children:"Low"}),(0,s.jsx)("option",{value:"Medium",children:"Medium"}),(0,s.jsx)("option",{value:"High",children:"High"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),(0,s.jsx)("input",{type:"date",value:l.startDate,onChange:e=>p("startDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),(0,s.jsx)("input",{type:"date",value:l.dueDate,onChange:e=>p("dueDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Team Members"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Project Team Members"}),0===l.assignedTo.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No team members assigned to this project"}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:l.assignedTo.map(e=>{let t=i.find(t=>t._id===e);return t?(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:t.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:t.email}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:t.department})]}),(0,s.jsx)("button",{onClick:()=>g(e),disabled:o,className:"text-red-600 hover:text-red-800 text-sm font-medium disabled:opacity-50 p-1 hover:bg-red-50 rounded ml-2",title:"Remove team member",children:(0,s.jsx)("i",{className:"ri-close-line w-4 h-4"})})]},e):null})})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Team Members"}),(0,s.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Search by name, email, or department...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["My Team Members (",b.length,")",(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"• Same Department"})]}),0===b.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No available team members from your department"}):(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3",children:b.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 py-2 cursor-pointer hover:bg-gray-50 rounded px-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:l.assignedTo.includes(e._id),onChange:()=>g(e._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.role," • ",e.department]})]})]},e._id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Adhoc Team Members (",j.length,")",(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"• Different Departments"})]}),0===j.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No team members from different departments available"}):(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3",children:j.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 py-2 cursor-pointer hover:bg-gray-50 rounded px-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:l.assignedTo.includes(e._id),onChange:()=>g(e._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.role," • ",e.department]})]})]},e._id))})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-8",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 cursor-pointer whitespace-nowrap",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700 cursor-pointer whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Saving...":"Save Changes"})]})]})]})})}function h({projectId:e,currentTeamMembers:t,onTeamUpdate:r,onClose:l}){let[n,i]=(0,a.useState)([]),[d,o]=(0,a.useState)([]),[c,x]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[b,j]=(0,a.useState)(""),[y,f]=(0,a.useState)(null),[v,N]=(0,a.useState)(t),[w,D]=(0,a.useState)(!1),k=e=>e.user&&e.user._id?e.user._id:e._id?e._id:"",S=e=>e.user&&e.user.name?e.user.name:e.name?e.name:"Unknown User",C=e=>e.user&&e.user.email?e.user.email:e.email?e.email:"",M=e=>e.user&&e.user.department?e.user.department:e.department?e.department:"",P=e=>v.some(t=>k(t)===e),{sameDepartment:T,differentDepartment:A}=y?{sameDepartment:n.filter(e=>e.department===y.department),differentDepartment:n.filter(e=>e.department!==y.department)}:{sameDepartment:[],differentDepartment:[]},_=async()=>{if(0===d.length)return void h("Please select at least one user");if(!e||""===e.trim())return void h("Invalid project ID");x(!0),h("");try{let t=d.map(e=>({userId:e})),s=d.map(e=>{let t=n.find(t=>t._id===e);return{user:{_id:e,name:t?.name||"Unknown User",email:t?.email||"",role:t?.role||"employee",department:t?.department||""}}});N(e=>[...e,...s]);try{await m.K.bulkAddTeamMembers(e,t)}catch(r){try{for(let r of t)await m.K.addTeamMember(e,r.userId)}catch(t){await m.K.addTeamMembersViaProjectUpdate(e,d)}}o([]),g(`Successfully added ${d.length} team member${1!==d.length?"s":""}!`),r(),setTimeout(()=>{l()},1500)}catch(e){console.error("Failed to add team members:",e),h(`Failed to add team members: ${e instanceof Error?e.message:"Unknown error"}`),N(t)}finally{x(!1)}},$=async s=>{if(confirm("Are you sure you want to remove this team member?")){x(!0),h("");try{if(!P(s))throw Error("User is not a team member");N(e=>e.filter(e=>k(e)!==s));try{await m.K.removeTeamMember(e,s)}catch(t){await m.K.removeTeamMemberViaProjectUpdate(e,s)}g("Team member removed successfully!"),r(),setTimeout(()=>{l()},1500)}catch(e){console.error("Failed to remove team member:",e),h(`Failed to remove team member: ${e instanceof Error?e.message:"Unknown error"}`),N(t)}finally{x(!1)}}},L=e=>{P(e)||o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-7xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Manage Team Members"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{N(t)},className:"text-blue-600 hover:text-blue-800 cursor-pointer p-1",title:"Refresh team members",children:(0,s.jsx)("i",{className:"ri-refresh-line w-5 h-5"})}),(0,s.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 cursor-pointer",children:(0,s.jsx)("i",{className:"ri-close-line w-6 h-6"})})]})]})}),u&&(0,s.jsx)("div",{className:"mx-6 mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:u}),p&&(0,s.jsx)("div",{className:"mx-6 mt-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm",children:p}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Current Project Team Members"}),v.length>5&&(0,s.jsx)("button",{onClick:()=>D(!w),className:"flex items-center text-sm text-blue-600 hover:text-blue-800 font-medium",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"ri-arrow-up-s-line mr-1"}),"Show Less"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"ri-arrow-down-s-line mr-1"}),"Show All (",v.length,")"]})})]}),0===v.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No team members assigned to this project"}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:(w?v:v.slice(0,5)).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:S(e)}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:C(e)}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:M(e)})]}),(0,s.jsx)("button",{onClick:()=>$(k(e)),disabled:c,className:"text-red-600 hover:text-red-800 text-sm font-medium disabled:opacity-50 p-1 hover:bg-red-50 rounded ml-2",title:"Remove team member",children:(0,s.jsx)("i",{className:"ri-close-line w-4 h-4"})})]},k(e)))})]}),d.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selected Users to Add:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map(e=>{let t=n.find(t=>t._id===e);return t?(0,s.jsxs)("div",{className:"flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[(0,s.jsx)("span",{children:t.name}),(0,s.jsx)("button",{onClick:()=>L(e),className:"ml-2 text-blue-600 hover:text-blue-800",children:(0,s.jsx)("i",{className:"ri-close-line w-3 h-3"})})]},e):null})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["My Team Members (",T.length,")",(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"• Same Department"})]}),0===T.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No available team members from your department"}):(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3",children:T.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 py-2 cursor-pointer hover:bg-gray-50 rounded px-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:d.includes(e._id)||P(e._id),onChange:()=>L(e._id),disabled:P(e._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.name,P(e._id)&&(0,s.jsx)("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Current Member"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.role," • ",e.department]})]})]},e._id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Adhoc Team Members (",A.length,")",(0,s.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"• Different Department"})]}),0===A.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"No available team members from other departments"}):(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-300 rounded-md p-3",children:A.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-3 py-2 cursor-pointer hover:bg-gray-50 rounded px-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:d.includes(e._id)||P(e._id),onChange:()=>L(e._id),disabled:P(e._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.name,P(e._id)&&(0,s.jsx)("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Current Member"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.email}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.role," • ",e.department]})]})]},e._id))})]})]}),d.length>0&&(0,s.jsx)("div",{className:"mt-6 flex justify-center",children:(0,s.jsx)("button",{onClick:_,disabled:c,className:"px-6 py-2 bg-blue-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Adding...":`Add ${d.length} Member${1!==d.length?"s":""} to Project`})})]})]})})}var p=r(1142),g=r(9361);function b(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!1),[d,o]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),[v,N]=(0,a.useState)(null),[w,D]=(0,a.useState)(!0),[k,S]=(0,a.useState)(""),[C,M]=(0,a.useState)("All"),[P,T]=(0,a.useState)(""),[A,_]=(0,a.useState)([]),[$,L]=(0,a.useState)("All Projects"),[E,F]=(0,a.useState)("list"),[I,U]=(0,a.useState)("All Departments"),[H,O]=(0,a.useState)(null),[q,R]=(0,a.useState)([]),[z,K]=(0,a.useState)([]),Y=async()=>{D(!0);try{if(console.log("Fetching projects..."),console.log("Current user:",H),console.log("Status filter:",C),console.log("Department filter:",I),!H||!H._id||!H.role||!H.department){console.error("Current user missing required fields:",H),S("User information is incomplete. Please log in again."),t([]);return}let e={status:"All"!==C?C:void 0};H?.role==="admin"&&(e.department=I),console.log("API params:",e);let r=await m.K.getProjects(e);console.log("Projects API response:",r),r&&r.projects&&Array.isArray(r.projects)?(t(r.projects),console.log("Projects set from paginated response:",r.projects)):Array.isArray(r)?(t(r),console.log("Projects set from array response:",r)):(console.error("Unexpected projects response format:",r),t([]))}catch(r){console.error("Failed to fetch projects:",r);let e="Failed to load projects";r instanceof Error&&(e=r.message.includes("500")?"Server error: Please check if you have proper permissions to view projects":r.message.includes("401")?"Authentication error: Please log in again":r.message.includes("403")?"Access denied: You do not have permission to view these projects":`Failed to load projects: ${r.message}`),S(e),t([])}D(!1)},G=(0,a.useMemo)(()=>{let t=Array.isArray(e)?e.filter(e=>null!=e):[];console.log("visibleProjects - projects array:",t);let r=t;if($&&"All Projects"!==$&&(r=r.filter(e=>e&&(e._id||e.id)===$)),!P)return r;let s=P.toLowerCase(),a=r.filter(e=>e&&[e.title,e.description].some(e=>e?.toLowerCase().includes(s)));return console.log("visibleProjects - filtered:",a),a},[e,P,$]),W=async e=>{try{console.log("Creating project with data:",e),console.log("API Base URL:",process.env.NEXT_PUBLIC_API_URL||"http://localhost:5000"),console.log("Auth token:",localStorage.getItem("token"));let t=await m.K.createProject(e);console.log("Project created successfully:",t),await Y(),l(!1)}catch(e){console.error("Failed to add project:",e),S(`Failed to add project: ${e instanceof Error?e.message:"Unknown error"}`)}},B=e=>{f(e),o(!0)},J=async(e,t)=>{try{await m.K.updateProject(e,t),await Y(),o(!1),f(null)}catch(e){console.error("Failed to update project:",e),S("Failed to update project")}},V=async e=>{if(e&&confirm("Are you sure you want to delete this project?"))try{await m.K.deleteProject(e),await Y()}catch(e){console.error("Failed to delete project:",e),S("Failed to delete project")}},Z=()=>{l(!1),o(!1),j(!1),f(null),N(null)},X=e=>{N(e),j(!0)},Q=async()=>{try{await new Promise(e=>setTimeout(e,300)),await Y(),await ee()}catch(e){console.error("Failed to update team data:",e)}},ee=async()=>{if(v)try{let e=await m.K.getProjectById(v._id);e&&N(e)}catch(e){console.error("Failed to refresh team management data:",e)}},et=e=>{if(!e)return"bg-gray-100 text-gray-800";switch(e){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},er=e=>!!H&&("admin"===H.role||"manager"===H.role&&e.department===H.department),es=e=>!!H&&("admin"===H.role||"manager"===H.role&&e.department===H.department);return H&&H._id&&H.role&&H.department?(0,s.jsx)(p.A,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("div",{className:"px-6 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Project Tracker"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage and track all your projects"}),H&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Role: ",H.role," • Department: ",H.department]})]}),!!H&&("admin"===H.role||"manager"===H.role)&&(0,s.jsxs)("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium cursor-pointer whitespace-nowrap flex items-center space-x-2",children:[(0,s.jsx)("i",{className:"ri-add-line w-5 h-5"}),(0,s.jsx)("span",{children:"Add New Project"})]})]}),k&&(0,s.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:k}),(0,s.jsx)("button",{onClick:()=>{S(""),Y()},className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Retry"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:(0,s.jsxs)("div",{className:"p-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsx)("select",{value:C,onChange:e=>M(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:["All","Active","Completed","On Hold"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),H?.role==="admin"&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),(0,s.jsxs)("select",{value:I,onChange:e=>U(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[(0,s.jsx)("option",{value:"All Departments",children:"All Departments"}),(q.length>0?q:g.uy).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,s.jsx)("input",{type:"text",value:P,onChange:e=>T(e.target.value),placeholder:"Search by title or description...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project"}),(0,s.jsxs)("select",{value:$,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[(0,s.jsx)("option",{value:"All Projects",children:"All Projects"}),A.map(e=>(0,s.jsx)("option",{value:e.id,children:e.title},e.id))]})]})]})}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)("div",{className:"flex space-x-2 bg-gray-100 rounded-full p-1",children:["gantt","list"].map(e=>(0,s.jsx)("button",{onClick:()=>F(e),className:`px-4 py-2 rounded-full text-sm font-medium ${E===e?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"gantt"===e?"Gantt View":"List View"},e))})}),"gantt"===E?(0,s.jsx)(c,{projects:G,tasks:z}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"All Projects"})}),(0,s.jsx)("div",{className:"p-6",children:w||!H?(0,s.jsx)("p",{children:H?"Loading projects...":"Loading user information..."}):(0,s.jsxs)("div",{className:"space-y-4",children:[Array.isArray(G)&&G.map(e=>(0,s.jsx)("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(n(),{href:`/project-tracker/${e?._id}`,className:"flex-1 cursor-pointer",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e?.title}),(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${et(e?.priority)}`,children:e?.priority})]}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:e?.description}),(0,s.jsxs)("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("i",{className:"ri-calendar-line w-4 h-4 mr-2"}),(0,s.jsxs)("span",{children:["Start: ",new Date(e?.startDate).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("i",{className:"ri-flag-line w-4 h-4 mr-2"}),(0,s.jsxs)("span",{children:["Due: ",new Date(e?.dueDate).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("i",{className:"ri-building-line w-4 h-4 mr-2"}),(0,s.jsx)("span",{children:e?.department||"No Department"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("i",{className:"ri-team-line w-4 h-4 mr-2"}),(0,s.jsxs)("span",{children:[e?.activeMembersCount||0," active members"]})]})]})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 ml-6",children:[(0,s.jsx)("span",{className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap ${e?.status==="Active"?"bg-green-100 text-green-800":e?.status==="Completed"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:e?.status}),er(e)&&(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),B(e)},className:"text-gray-600 hover:text-gray-800 cursor-pointer",title:"Edit Project",children:(0,s.jsx)("i",{className:"ri-edit-line w-5 h-5"})}),er(e)&&(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),X(e)},className:"text-blue-600 hover:text-blue-800 cursor-pointer",title:"Manage Team",children:(0,s.jsx)("i",{className:"ri-team-line w-5 h-5"})}),es(e)&&(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),e._id&&V(e._id)},className:"text-red-600 hover:text-red-800 cursor-pointer",title:"Delete Project",children:(0,s.jsx)("i",{className:"ri-delete-bin-line w-5 h-5"})}),(0,s.jsx)(n(),{href:`/project-tracker/${e?._id}`,children:(0,s.jsx)("i",{className:"ri-arrow-right-line w-5 h-5 text-gray-400"})})]})]})},e?._id||e?.id||Math.random())),(!Array.isArray(G)||0===G.length)&&!w&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:Array.isArray(G)?"No projects found with current filters.":"Error loading projects"})]})})]})]})}),r&&(0,s.jsx)(x,{onSave:W,onClose:Z}),d&&y&&(0,s.jsx)(u,{project:y,onSave:J,onClose:Z}),b&&v&&(0,s.jsx)(h,{projectId:v._id,currentTeamMembers:v.teamMembers||[],onTeamUpdate:Q,onClose:()=>{j(!1),N(null)}},`team-management-${v._id}-${JSON.stringify(v.teamMembers)}`)]})}):(0,s.jsx)(p.A,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading user information..."}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Please wait while we verify your permissions"})]})})]})})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4125:(e,t,r)=>{Promise.resolve().then(r.bind(r,2862))},5386:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o});var s=r(5239),a=r(8088),l=r(8170),n=r.n(l),i=r(893),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(t,d);let o={children:["",{children:["project-tracker",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1490)),"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\project-tracker\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,2366)),"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\project-tracker\\page.tsx"],m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/project-tracker/page",pathname:"/project-tracker",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5565:(e,t,r)=>{Promise.resolve().then(r.bind(r,1490))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9361:(e,t,r)=>{"use strict";r.d(t,{fn:()=>i,gg:()=>l,lk:()=>a,lx:()=>n,uy:()=>s});let s=["Supply Chain-Operations","Human Resources and Administration","New Product Design","India E-commerce","Supply Chain","Data Analytics","E-commerce","Retail E-commerce","Finance & Accounts","Zonal Sales (India)- HORECA","Zonal Sales (India)","Supply Chain & Operation","Zonal Sales","Digital Marketing"],a="India E-commerce",l=["admin","manager","employee"],n="employee",i={admin:"Administrator",manager:"Manager",employee:"Employee"}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,285,418,122],()=>r(5386));module.exports=s})();
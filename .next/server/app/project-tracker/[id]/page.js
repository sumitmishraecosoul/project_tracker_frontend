(()=>{var e={};e.id=241,e.ids=[241],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1657:(e,t,r)=>{"use strict";r.d(t,{default:()=>x});var s=r(687),a=r(3210),o=r(5814),i=r.n(o),n=r(124),l=r(2773),c=r(2153),d=r(3966);function x({projectId:e}){let[t,r]=(0,a.useState)(null),[o,x]=(0,a.useState)([]),[p,m]=(0,a.useState)(!0),[u,g]=(0,a.useState)(""),[h,y]=(0,a.useState)(!1),[j,f]=(0,a.useState)(!1),[k,b]=(0,a.useState)(null),[w,N]=(0,a.useState)(null);console.log("ProjectDetail component rendered with projectId:",e);let v=async()=>{m(!0),g("");try{if(console.log("Fetching project data for ID:",e),console.log("Project ID type:",typeof e),console.log("Project ID length:",e.length),!e||""===e.trim())throw Error("Invalid project ID");let t=await d.K.getProjectById(e);if(console.log("Project API response:",t),t&&t.project)r(t.project),x(t.tasks||[]),console.log("Project set successfully:",t.project),console.log("Tasks set successfully:",t.tasks),console.log("Number of tasks:",t.tasks?t.tasks.length:0);else if(t&&t._id){r(t),console.log("Project set directly (legacy format):",t);try{let t=await d.K.getProjectTasks(e);x(Array.isArray(t)?t:[]),console.log("Tasks fetched separately:",t)}catch(e){console.log("Could not fetch tasks separately:",e),x([])}}else throw Error("Invalid project response format")}catch(e){console.error("Failed to fetch project data:",e),g("Project not found or failed to load project data")}m(!1)},D=e=>{console.log("Edit task clicked:",e),b(e),f(!0)},P=e=>!!w&&("admin"===w.role||"manager"===w.role||"employee"===w.role&&(e.assignedTo._id===w._id||e.reporter._id===w._id)),T=e=>!!w&&("admin"===w.role||"manager"===w.role||(w.role,!1)),S=async e=>{if(!e)return void console.error("No task ID provided for deletion");if(confirm("Are you sure you want to delete this task?"))try{console.log("Deleting task with ID:",e),await d.K.deleteTask(e),console.log("Task deleted successfully"),await v()}catch(e){console.error("Failed to delete task:",e),g("Failed to delete task")}};return p?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(n.A,{}),(0,s.jsx)("div",{className:"px-6 py-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,s.jsx)("p",{className:"text-center text-gray-600",children:"Loading project..."})})})]}):t?(console.log("Rendering project detail with project:",t),console.log("Rendering project detail with tasks:",o),console.log("Tasks length:",o.length),console.log("Current user state:",w),console.log("Can create task:",!!w),o.forEach((e,t)=>{console.log(`Task ${t}:`,{taskId:e._id,taskName:e.task,assignedTo:e.assignedTo,reporter:e.reporter,canEdit:P(e),canDelete:T(e)})}),(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(n.A,{}),(0,s.jsx)("div",{className:"px-6 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)(i(),{href:"/project-tracker",className:"text-blue-600 hover:text-blue-800 text-sm font-medium cursor-pointer",children:"← Back to Projects"}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mt-4 mb-2",children:t.title}),(0,s.jsx)("p",{className:"text-gray-600",children:t.description}),w&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Role: ",w.role," • Department: ",w.department]})]}),u&&(0,s.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:u}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Status"}),(0,s.jsx)("span",{className:`inline-block mt-1 px-3 py-1 rounded-full text-sm font-medium ${"Active"===t.status?"bg-green-100 text-green-800":"Completed"===t.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Priority"}),(0,s.jsx)("span",{className:`inline-block mt-1 px-3 py-1 rounded-full text-sm font-medium ${"High"===t.priority?"bg-red-100 text-red-800":"Medium"===t.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:t.priority})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Start Date"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:new Date(t.startDate).toLocaleDateString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Due Date"}),(0,s.jsx)("p",{className:"mt-1 text-gray-900",children:new Date(t.dueDate).toLocaleDateString()})]})]})})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Project Tasks"}),!!w&&(0,s.jsxs)("button",{onClick:()=>y(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 cursor-pointer whitespace-nowrap flex items-center",children:[(0,s.jsx)("i",{className:"ri-add-line w-4 h-4 mr-2"}),"Add New Task"]})]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Task ID"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Task"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned To"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reporter"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hours"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sprint"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[o.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.id}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.task}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:e.description}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"Daily"===e.taskType?"bg-blue-100 text-blue-800":"Weekly"===e.taskType?"bg-purple-100 text-purple-800":"Monthly"===e.taskType?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.taskType})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"Completed"===e.status?"bg-green-100 text-green-800":"In Progress"===e.status?"bg-yellow-100 text-yellow-800":"Blocked"===e.status?"bg-red-100 text-red-800":"On Hold"===e.status?"bg-orange-100 text-orange-800":"Cancelled"===e.status?"bg-gray-200 text-gray-800":"bg-gray-100 text-gray-800"}`,children:e.status})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"Critical"===e.priority?"bg-red-100 text-red-800":"High"===e.priority?"bg-orange-100 text-orange-800":"Medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:e.priority})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.assignedTo?.name||"Unassigned"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.reporter?.name||"Unknown"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.startDate?new Date(e.startDate).toLocaleDateString():"Not set"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.eta).toLocaleDateString()}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.actualHours||0,"/",e.estimatedHours||0]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.sprint||"Not set"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[P(e)&&(0,s.jsxs)("button",{onClick:()=>D(e),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 shadow-sm",title:"Edit Task",children:[(0,s.jsx)("i",{className:"ri-edit-line w-3 h-3 mr-1"}),"Edit"]}),T(e)&&(0,s.jsxs)("button",{onClick:()=>S(e._id),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200 shadow-sm",title:"Delete Task",children:[(0,s.jsx)("i",{className:"ri-delete-bin-line w-3 h-3 mr-1"}),"Delete"]})]})})]},e._id)),0===o.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:13,className:"px-6 py-8 text-center text-gray-500",children:"No tasks found for this project."})})]})]})})]})]})}),h&&(0,s.jsx)(l.A,{projectId:e,onAdd:e=>{console.log("New task added:",e),y(!1),v()},onClose:()=>y(!1)}),j&&k&&(0,s.jsx)(c.A,{task:k,onSave:e=>{(async()=>{try{console.log("Saving updated task:",e);let t={task:e.task,description:e.description,taskType:e.taskType,status:e.status,priority:e.priority,assignedTo:e.assignedTo._id,reporter:e.reporter._id,startDate:e.startDate,eta:e.eta,estimatedHours:e.estimatedHours,actualHours:e.actualHours,remark:e.remark,roadBlock:e.roadBlock,supportNeeded:e.supportNeeded,labels:e.labels,attachments:e.attachments,relatedTasks:e.relatedTasks,parentTask:e.parentTask,sprint:e.sprint};console.log("Task data for API:",t),await d.K.updateTask(e._id,t),console.log("Task updated successfully"),f(!1),b(null),await v()}catch(e){console.error("Failed to update task:",e),g("Failed to update task")}})()},onClose:()=>f(!1)})]})):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(n.A,{}),(0,s.jsx)("div",{className:"px-6 py-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,s.jsx)("p",{className:"text-center text-gray-600",children:"Project not found"})})})]})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},7540:(e,t,r)=>{Promise.resolve().then(r.bind(r,1657))},8367:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Sumit Mishra\\\\OneDrive - EcoSoul Home\\\\Documents\\\\Project trackerr\\\\Project tracker\\\\app\\\\project-tracker\\\\[id]\\\\ProjectDetail.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\project-tracker\\[id]\\ProjectDetail.tsx","default")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9406:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,generateStaticParams:()=>o});var s=r(7413),a=r(8367);async function o(){return[{id:"1"},{id:"2"},{id:"3"}]}async function i({params:e}){let{id:t}=await e;return console.log("ProjectPage component - received project ID:",t),(0,s.jsx)(a.default,{projectId:t})}},9820:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(5239),a=r(8088),o=r(8170),i=r.n(o),n=r(893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let c={children:["",{children:["project-tracker",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9406)),"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\project-tracker\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,2366)),"C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["C:\\Users\\Sumit Mishra\\OneDrive - EcoSoul Home\\Documents\\Project trackerr\\Project tracker\\app\\project-tracker\\[id]\\page.tsx"],x={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/project-tracker/[id]/page",pathname:"/project-tracker/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9924:(e,t,r)=>{Promise.resolve().then(r.bind(r,8367))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,285,418,122,648],()=>r(9820));module.exports=s})();